
const express = require('express');

const sso = require('.');

const app = express();

const users = {
    akoenig: {
        password: 'test123'
    },
};

const restricted = sso(app, {
    facebook: {
        clientID: "259412487867679",
        clientSecret: "090817ce94b51015d16d9e8dfbd7a8d2",
        callbackURL: "http://localhost:8080/auth/facebook/callback",
        successRedirect: "/",
        failureRedirect: "/login",
    },
    local: {
        verify: (username, password, callback) => {
            const user = users[username];

            if (!user || user.password !== password) {
                return callback(null, false);
            }

            callback(null, user);
        },
        successRedirect: "/",
        failureRedirect: "/login",
    },
});

app.get('/login', (req, res) => {
    res.send('LOGIN')
})

app.get('/', (req, res) => {
    console.log('User', req.user);

    res.send('OK');
});

app.listen(8080);