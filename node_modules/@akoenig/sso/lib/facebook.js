/**
 * @akoenig/sso
 *
 * Copyright, 2017, André König <hello@andrekoenig.de>
 *
 * MIT licensed
 *
 */

const FacebookStrategy = require('passport-facebook');

const facebook = (app, passport, config) => {
    passport.use(new FacebookStrategy({
        clientID: config.clientID,
        clientSecret: config.clientSecret,
        callbackURL: config.callbackURL,
    }, (accessToken, refreshToken, profile, done) => {
        done(null, profile);
    }));

    app.get('/auth/facebook',
        passport.authenticate('facebook'));

    app.get('/auth/facebook/callback',
        passport.authenticate('facebook', {
            successRedirect: config.successRedirect,
            failureRedirect: config.failureRedirect,
        })
    );
};

module.exports.facebook = facebook;
