/**
 * @akoenig/sso
 *
 * Copyright, 2017, André König <hello@andrekoenig.de>
 *
 * MIT licensed
 *
 */

const { Strategy: LocalStrategy } = require('passport-local');

const local = (app, passport, config) => {
    passport.use(new LocalStrategy(config.verify));

    app.post('/auth/local',
        passport.authenticate('local', {
            successRedirect: config.successRedirect,
            failureRedirect: config.failureRedirect,
        })
    );
};

module.exports.local = local;
